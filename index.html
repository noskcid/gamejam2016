<!doctype html>
<html>
    <head>
        <meta charset="UTF-8" />
        <title>Immortals</title>
	<style>
		canvas {
			display: block;
			background-color: rgba(159, 216, 251, 1);
			padding-left: 0;
			padding-right: 0;
			margin-left: auto;
			margin-right: auto;
		}
	</style>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
	<script src="js/engine.js"></script>
	<script type="text/javascript">
		farming = 0;
		fishing = 0;
		available = 10;
		var context;
		var centerX;
		var centerY;
		var cupid_img;
		var house_img;

		function loadImages() {
			cupid_img = new Image();
			cupid_img.src = "images/gods/resized/cupid_cropped_backup.jpg";
			cupid_img2 = new Image();
			cupid_img2.src = "images/gods/resized/cupid_cropped.jpg";
			house_img = new Image();
			house_img.src = "images/house.png";
		}
		
		function redraw() {
			$("#year").text(year);
			$("#pop").text(population);
		}

		function draw() {
			context.drawImage(house_img, centerX-(178/2), centerY-(99/2));
			
			var pattern = context.createPattern(cupid_img, 'repeat');

			context.beginPath();
      		context.arc(100, 100, 100, 0, 2 * Math.PI, false);
      		context.fillStyle = pattern;
      		context.fill();
      		context.lineWidth = 2;
      		context.strokeStyle = '#000000';
      		context.stroke();

			context.drawImage(cupid_img2, 200,100);

			/*
			context.save();
    		context.beginPath();
    		context.arc(25, 25, 25, 0, Math.PI * 2, true);
    		context.closePath();
    		context.clip();

    		context.drawImage(cupid_img, 0, 0, 50, 50);

    		context.beginPath();
    		context.arc(0, 0, 25, 0, Math.PI * 2, true);
    		context.clip();
    		context.closePath();
    		context.restore();
			*/

		}
		
		loadImages();

		$(document).ready(function () {
			context = document.getElementById('game').getContext("2d");
			centerX = 1300 / 2;
      		centerY = 700 / 2;
			
			/*
			var img = new Image();
			img.onload = function () {
    			context.drawImage(img, centerX-(178/2), centerY-(99/2));
			}
			img.src = "images/house.png";
			*/

			// Create fill gradient
			/*
			var gradient = context.createLinearGradient(0, 0, 0, 5);
			gradient.addColorStop(0, "#ffc821");
			gradient.addColorStop(1, "#faf100");

			context.beginPath();
      		context.arc(15, 15, 10, 0, 2 * Math.PI, false);
      		context.fillStyle = gradient;
      		context.fill();
      		context.lineWidth = 2;
      		context.strokeStyle = '#000000';
      		context.stroke();


			var thumbImg = new Image();
			thumbImg.src = "images/gods/resized/cupid_cropped.jpg";
			thumbImg.onload = function() {
    			//tmpCtx.save();
    			//tmpCtx.beginPath();
    			//tmpCtx.arc(25, 25, 25, 0, Math.PI * 2, true);
    			//tmpCtx.closePath();
    			//tmpCtx.clip();

    			context.drawImage(thumbImg, 0, 0, 100, 100);

    			//tmpCtx.beginPath();
    			//tmpCtx.arc(0, 0, 25, 0, Math.PI * 2, true);
    			//tmpCtx.clip();
    			//tmpCtx.closePath();
    			//tmpCtx.restore();
			};
			*/

			// Grid height correction for Colour
			//$("#colour").height($("#rain").height());

			// Update every minute
			interval = setInterval(function(){
				update();
				redraw();
			}, 1000);

			$('input.farming').click(function (event) {
				if (event.target.id == 'plus') {
					if (available > 0) {
						farming += 1;
						available -= 1;
					}
				} else {
					if (farming > 0) {
						farming -= 1;
						available += 1;
					}
				}
				$("#farming").text(farming);	
			});
			$('input.fishing').click(function (event) {
				if (event.target.id == 'plus') {
					if (available > 0) {
						fishing += 1;
						available -= 1;
					}
				} else {
					if (farming > 0) {
						fishing -= 1;
						available += 1;
					}
				}
				$("#fishing").text(fishing);	
			});


		});

		$(window).on("load", function() {
    		console.log("All images loaded");
			draw();
		});

		
	</script>
    </head>
    <body>
	<p>Year: <span id="year"></span> Population: <span id="pop"></span></p>
	<canvas id="game" width="1300px" height="700px" style="border:1px solid #000000">
	
	</canvas>
	<h3>Metrics</h3>
	<p>Happiness: <span id="happiness"></span></p>
	<p>Overcrowding: <span id="overcrowding"></span></p>
	<p>Health: <span id="health"></span></p>
	<p>Birthrate: <span id="birthrate"></span></p>
	<p>Deathrate: <span id="deathrate"></span></p>
	<p>Delta Population: <span id="deltapopulation"></span></p>



	<h3>Control</h3>
	<p>Farming: <span id="farming">0</span>
		<input class="farming" id="plus" type="submit" value="+">
		<input class="farming" id="minus" type="submit" value="-">
	</p>
	<p>Fishing: <span id="fishing">0</span>
		<input class="fishing" id="plus" type="submit" value="+">
		<input class="fishing" id="minus" type="submit" value="-">
	</p>
	<p>Livestock: </p>
	<p>Irrigation: </p>
	<p>Transport: </p>
	<p>Wood: </p>
	<p>Stone: </p>
	<p>Worship: </p>
	<p>Leisure: </p>

	 </body>
</html>
